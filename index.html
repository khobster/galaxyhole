<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Cornhole Physics</title>
  <style>
    /* Previous styles remain the same until the bag positioning */
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, sans-serif;
    }

    #game-container {
      width: 100vw;
      height: 100vh;
      position: relative;
      perspective: 2000px;
      background: linear-gradient(#87CEEB, #90EE90);
      overflow: hidden;
    }

    #court {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transform: rotateX(65deg); /* Adjusted for better visibility */
    }

    #board {
      position: absolute;
      width: 120px;
      height: 240px;
      left: 50%;
      top: 10%;          /* Moved down slightly */
      transform: translate(-50%, 0);
      background: #8B4513;
      border: 4px solid #654321;
      border-radius: 4px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    #hole {
      position: absolute;
      width: 30px;
      height: 30px;
      left: 50%;
      top: 25%;
      transform: translate(-50%, -50%);
      background: #000;
      border-radius: 50%;
    }

    #bag {
      position: absolute;
      width: 40px;
      height: 40px;
      left: calc(50% - 20px);
      bottom: 150px;    /* Moved back further */
      background: #c41e3a;
      border-radius: 5px;
      transform-style: preserve-3d;
    }

    /* Keep existing UI styles */
</style>
</head>
<body>
<!-- Keep existing HTML structure -->

<script>
// Keep existing planets data and DOM elements setup

function throwBag() {
  if (isAnimating) return;
  isAnimating = true;

  const power = parseFloat(powerRange.value);
  const angleDeg = parseFloat(angleRange.value);
  const angleRad = angleDeg * Math.PI / 180;
  const g = currentPlanet.gravity;

  // Adjusted scaling factors
  const METERS_TO_PIXELS = 50;  // Reduced to make distances more manageable
  const REAL_DISTANCE = 8.23;   // ~27 feet in meters
  const TIME_SCALE = 1.5;       // Slowed down animation
  
  // Initial velocity adjusted for better visualization
  const v0 = power * 0.5 * (7 / currentPlanet.throwAdjustment);

  let startTime = null;

  function animate(currentTime) {
    if (!startTime) startTime = currentTime;
    let t = (currentTime - startTime) / 1000 * TIME_SCALE;

    // Calculate position using physics equations
    const x = 0; // No lateral movement
    const z = v0 * Math.cos(angleRad) * t;
    const y = v0 * Math.sin(angleRad) * t - (0.5 * g * t * t);

    // Scale positions to screen space
    const screenZ = z * METERS_TO_PIXELS;
    const screenY = y * METERS_TO_PIXELS;

    // Calculate distance to board for collision detection
    const boardZ = REAL_DISTANCE * METERS_TO_PIXELS;
    
    // End conditions: hit ground, reached board, or timeout
    if (y < 0 || z > REAL_DISTANCE || t > 4) {
      isAnimating = false;
      
      // If near the board, show landing animation
      if (Math.abs(z - REAL_DISTANCE) < 0.5) {
        // Landing animation - slide slightly
        const finalY = 0;
        const finalZ = boardZ;
        const finalScale = 0.3;
        
        bag.style.transform = `translate3d(${x}px, ${-finalY}px, ${finalZ}px) 
                             scale(${finalScale}) rotateX(0deg)`;
      }
      
      // Reset after delay
      setTimeout(() => {
        bag.style.transform = 'translate3d(0, 0, 0)';
      }, 2000);
      
      return;
    }

    // Improved scaling calculation
    const distanceRatio = screenZ / (REAL_DISTANCE * METERS_TO_PIXELS);
    const scale = Math.max(0.3, 1 - (distanceRatio * 0.7));
    
    // Rotation based on trajectory
    const rotationSpeed = 360; // degrees per second
    const rotation = t * rotationSpeed;
    
    // Apply transforms with proper perspective
    bag.style.transform = `translate3d(${x}px, ${-screenY}px, ${screenZ}px) 
                          scale(${scale}) 
                          rotateX(${rotation}deg) 
                          rotateY(${rotation * 0.5}deg)`;

    if (isAnimating) {
      requestAnimationFrame(animate);
    }
  }

  requestAnimationFrame(animate);
}

// Keep existing event listeners and initialization
</script>
</body>
</html>
