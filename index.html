<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Space Cornhole — Single Screen</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:system-ui,Segoe UI,Roboto,sans-serif;background:linear-gradient(#87CEEB 0%,#90EE90 100%);overflow:hidden}
    #ui{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;pointer-events:none}
    #controls{margin-top:1rem;display:flex;gap:.5rem;pointer-events:auto}
    select,button{padding:.4rem .8rem;font-size:1rem;border-radius:.5rem;border:2px solid #444;background:#fff;color:#222;font-weight:600;cursor:pointer}
    #score{margin-top:.5rem;font-size:1.2rem;font-weight:700;background:#ffffffb3;padding:.4rem .8rem;border-radius:.5rem}
    #board{position:absolute;width:120px;height:240px;left:50%;top:40%;transform:translate(-50%,-50%) rotateX(20deg);background:#8B4513;border:4px solid #654321;border-radius:4px;box-shadow:0 20px 40px rgba(0,0,0,.4)}
    #hole{position:absolute;width:38px;height:38px;left:50%;top:25%;transform:translate(-50%,-50%);border-radius:50%;background:#000;box-shadow:inset 0 0 10px rgba(0,0,0,.6)}
    .bag{position:absolute;width:40px;height:40px;border-radius:5px;box-shadow:0 5px 10px rgba(0,0,0,.3);will-change:transform;background:#c41e3a}
  </style>
</head>
<body>
  <div id="ui">
    <div id="controls">
      <label for="planet">Gravity:</label>
      <select id="planet">
        <option value="earth">Earth</option>
        <option value="moon">Moon</option>
        <option value="mars">Mars</option>
        <option value="jupiter">Jupiter</option>
      </select>
      <button id="reset">Reset Game</button>
    </div>
    <div id="score">Score 0</div>
  </div>

  <div id="board">
    <div id="hole"></div>
  </div>

<script>
//--- Setup
const planets={earth:{g:9.81,adjust:1},moon:{g:1.62,adjust:0.5},mars:{g:3.72,adjust:0.7},jupiter:{g:24.79,adjust:1.5}};
let current=planets.earth;
const planetSel=document.getElementById('planet');
planetSel.addEventListener('change',e=>{current=planets[e.target.value]});

let score=0;const scoreEl=document.getElementById('score');
function updateScore(v){score+=v;scoreEl.textContent=`Score ${score}`}

autoResize();window.addEventListener('resize',autoResize);
function autoResize(){boardRect=document.getElementById('board').getBoundingClientRect();holeRect=document.getElementById('hole').getBoundingClientRect();}
let boardRect,holeRect;

//--- Throw mechanics
let dragging=false,startX=0,startY=0,startT=0;
const MIN_DIST=10;
const gameArea=document.body;

gameArea.addEventListener('mousedown',startDrag);
gameArea.addEventListener('touchstart',e=>startDrag(e.touches[0]));
function startDrag(e){if(dragging)return;dragging=true;startX=e.clientX;startY=e.clientY;startT=performance.now();}

gameArea.addEventListener('mouseup',endDrag);
gameArea.addEventListener('mouseleave',endDrag);
gameArea.addEventListener('touchend',e=>{if(e.changedTouches[0])endDrag(e.changedTouches[0])});
function endDrag(e){if(!dragging)return;dragging=false;const dx=e.clientX-startX,dy=startY-e.clientY;const dist=Math.hypot(dx,dy);if(dist<MIN_DIST)return;
  const time=(performance.now()-startT);const vel=dist/time;const power=vel*550*current.adjust; // tuned multiplier
  const angle=Math.atan2(dy,dx);
  throwBag(power,angle);
}

function throwBag(power,angle){const bag=document.createElement('div');bag.className='bag';document.body.appendChild(bag);
  const start={x:window.innerWidth/2-20,y:window.innerHeight-120};
  let t0=performance.now();const g=current.g*30; // scale gravity for screen px
  const vx=Math.cos(angle)*power, vy=Math.sin(angle)*power;
  function step(t){const dt=(t-t0)/1000;const x=start.x+vx*dt;const y=start.y - (vy*dt - .5*g*dt*dt);
    bag.style.transform=`translate(${x}px,${y}px)`;
    if(y<window.innerHeight){requestAnimationFrame(step);} else {land(x+20,y+20);bag.remove();} }
  requestAnimationFrame(step);
  function land(cx,cy){ // cx,cy are center coords of bag
    // hit detection
    if(pointInCircle(cx,cy,holeRect)){updateScore(3);return;}
    if(cx>boardRect.left && cx<boardRect.right && cy>boardRect.top && cy<boardRect.bottom){updateScore(1);} }
}
function pointInCircle(x,y,rect){const dx=x-(rect.left+rect.width/2);const dy=y-(rect.top+rect.height/2);return Math.hypot(dx,dy)<rect.width/2;}

document.getElementById('reset').addEventListener('click',()=>{score=0;updateScore(0)});
</script>
</body>
</html>
